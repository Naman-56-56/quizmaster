{% extends 'base.html' %}

{% block content %}
<div class="max-w-2xl mx-auto mt-12">
    <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8 text-white text-center">
        <h1 class="text-3xl font-bold mb-6">Choose a Quiz</h1>
        <p class="mb-8">Welcome, <span id="userNameDisplay"></span>! Select a quiz to join:</p>
        <div id="quizList" class="grid gap-6"></div>
    </div>
</div>
<script>
// Get user name from query param or localStorage
const params = new URLSearchParams(window.location.search);
let userName = params.get('name') || localStorage.getItem('userName') || '';
if (userName) {
    document.getElementById('userNameDisplay').textContent = userName;
    localStorage.setItem('userName', userName);
}

// Fetch quizzes from backend
fetch('/api/quizzes/')
    .then(res => res.json())
    .then(data => {
        const quizList = document.getElementById('quizList');
        if (data.quizzes && data.quizzes.length > 0) {
            data.quizzes.forEach(quiz => {
                const div = document.createElement('div');
                div.className = 'bg-white/20 rounded-xl p-6 text-left flex flex-col items-start';
                div.innerHTML = `
                    <h2 class="text-xl font-bold mb-2">${quiz.title}</h2>
                    <p class="mb-2 text-sm opacity-80">${quiz.description || ''}</p>
                    <button class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold mt-2" onclick="window.location.href='/host/${quiz.game_code}/'">Join</button>
                `;
                quizList.appendChild(div);
            });
        } else {
            quizList.innerHTML = '<p class="text-lg">No quizzes available.</p>';
        }
    });
</script>
{% endblock %}
